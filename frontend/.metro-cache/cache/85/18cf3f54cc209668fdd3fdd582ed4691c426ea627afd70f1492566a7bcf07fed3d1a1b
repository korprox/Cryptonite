{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"]}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/Alert","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"PEUC6jrQVoAGZ2qYkvimljMOyJI=","exportNames":["*"]}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":198},"end":{"line":4,"column":35,"index":233}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"]}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = AuthProvider;\n  exports.useAuth = void 0;\n  var _react = _interopRequireWildcard(require(_dependencyMap[1], \"react\"));\n  var _asyncStorage = _interopRequireDefault(require(_dependencyMap[2], \"@react-native-async-storage/async-storage\"));\n  var _Alert = _interopRequireDefault(require(_dependencyMap[3], \"react-native-web/dist/exports/Alert\"));\n  var _api = require(_dependencyMap[4], \"../utils/api\");\n  var _jsxDevRuntime = require(_dependencyMap[5], \"react/jsx-dev-runtime\");\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  function _interopRequireWildcard(e, t) { if (\"function\" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) \"default\" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const useAuth = () => {\n    _s();\n    const context = (0, _react.useContext)(AuthContext);\n    if (!context) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n  exports.useAuth = useAuth;\n  _s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  function AuthProvider({\n    children\n  }) {\n    _s2();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const isAuthenticated = !!user;\n    (0, _react.useEffect)(() => {\n      checkAuthStatus();\n    }, []);\n    const checkAuthStatus = async () => {\n      try {\n        const token = await _asyncStorage.default.getItem('auth_token');\n        const userData = await _asyncStorage.default.getItem('user_data');\n        if (token && userData) {\n          const parsedUser = JSON.parse(userData);\n          setUser({\n            ...parsedUser,\n            token\n          });\n        } else {\n          // Auto-login for anonymous users\n          await login();\n        }\n      } catch (error) {\n        console.log('Auth check error:', error);\n        await login(); // Fallback to anonymous login\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async () => {\n      try {\n        setIsLoading(true);\n        const response = await _api.api.post('/auth/anonymous', {});\n        if (!response.ok) {\n          throw new Error('Failed to create anonymous user');\n        }\n        const userData = await response.json();\n        await _asyncStorage.default.setItem('auth_token', userData.token);\n        await _asyncStorage.default.setItem('user_data', JSON.stringify({\n          id: userData.id,\n          anonymous_id: userData.anonymous_id,\n          display_name: userData.display_name\n        }));\n        setUser(userData);\n      } catch (error) {\n        console.error('Login error:', error);\n        _Alert.default.alert('Ошибка', 'Не удалось войти в приложение');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        await _asyncStorage.default.removeItem('auth_token');\n        await _asyncStorage.default.removeItem('user_data');\n        setUser(null);\n\n        // Immediately create new anonymous user\n        await login();\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _jsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        isAuthenticated\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 5\n    }, this);\n  }\n  _s2(AuthProvider, \"YajQB7LURzRD+QP5gw0+K2TZIWA=\");\n  _c = AuthProvider;\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":112,"map":[[8,2,1,0],[8,6,1,0,"_react"],[8,12,1,0],[8,15,1,0,"_interopRequireWildcard"],[8,38,1,0],[8,39,1,0,"require"],[8,46,1,0],[8,47,1,0,"_dependencyMap"],[8,61,1,0],[9,2,2,0],[9,6,2,0,"_asyncStorage"],[9,19,2,0],[9,22,2,0,"_interopRequireDefault"],[9,44,2,0],[9,45,2,0,"require"],[9,52,2,0],[9,53,2,0,"_dependencyMap"],[9,67,2,0],[10,2,2,69],[10,6,2,69,"_Alert"],[10,12,2,69],[10,15,2,69,"_interopRequireDefault"],[10,37,2,69],[10,38,2,69,"require"],[10,45,2,69],[10,46,2,69,"_dependencyMap"],[10,60,2,69],[11,2,4,0],[11,6,4,0,"_api"],[11,10,4,0],[11,13,4,0,"require"],[11,20,4,0],[11,21,4,0,"_dependencyMap"],[11,35,4,0],[12,2,4,35],[12,6,4,35,"_jsxDevRuntime"],[12,20,4,35],[12,23,4,35,"require"],[12,30,4,35],[12,31,4,35,"_dependencyMap"],[12,45,4,35],[13,2,4,35],[13,6,4,35,"_jsxFileName"],[13,18,4,35],[14,4,4,35,"_s"],[14,6,4,35],[14,9,4,35,"$RefreshSig$"],[14,21,4,35],[15,4,4,35,"_s2"],[15,7,4,35],[15,10,4,35,"$RefreshSig$"],[15,22,4,35],[16,2,4,35],[16,11,4,35,"_interopRequireWildcard"],[16,35,4,35,"e"],[16,36,4,35],[16,38,4,35,"t"],[16,39,4,35],[16,68,4,35,"WeakMap"],[16,75,4,35],[16,81,4,35,"r"],[16,82,4,35],[16,89,4,35,"WeakMap"],[16,96,4,35],[16,100,4,35,"n"],[16,101,4,35],[16,108,4,35,"WeakMap"],[16,115,4,35],[16,127,4,35,"_interopRequireWildcard"],[16,150,4,35],[16,162,4,35,"_interopRequireWildcard"],[16,163,4,35,"e"],[16,164,4,35],[16,166,4,35,"t"],[16,167,4,35],[16,176,4,35,"t"],[16,177,4,35],[16,181,4,35,"e"],[16,182,4,35],[16,186,4,35,"e"],[16,187,4,35],[16,188,4,35,"__esModule"],[16,198,4,35],[16,207,4,35,"e"],[16,208,4,35],[16,214,4,35,"o"],[16,215,4,35],[16,217,4,35,"i"],[16,218,4,35],[16,220,4,35,"f"],[16,221,4,35],[16,226,4,35,"__proto__"],[16,235,4,35],[16,243,4,35,"default"],[16,250,4,35],[16,252,4,35,"e"],[16,253,4,35],[16,270,4,35,"e"],[16,271,4,35],[16,294,4,35,"e"],[16,295,4,35],[16,320,4,35,"e"],[16,321,4,35],[16,330,4,35,"f"],[16,331,4,35],[16,337,4,35,"o"],[16,338,4,35],[16,341,4,35,"t"],[16,342,4,35],[16,345,4,35,"n"],[16,346,4,35],[16,349,4,35,"r"],[16,350,4,35],[16,358,4,35,"o"],[16,359,4,35],[16,360,4,35,"has"],[16,363,4,35],[16,364,4,35,"e"],[16,365,4,35],[16,375,4,35,"o"],[16,376,4,35],[16,377,4,35,"get"],[16,380,4,35],[16,381,4,35,"e"],[16,382,4,35],[16,385,4,35,"o"],[16,386,4,35],[16,387,4,35,"set"],[16,390,4,35],[16,391,4,35,"e"],[16,392,4,35],[16,394,4,35,"f"],[16,395,4,35],[16,411,4,35,"t"],[16,412,4,35],[16,416,4,35,"e"],[16,417,4,35],[16,433,4,35,"t"],[16,434,4,35],[16,441,4,35,"hasOwnProperty"],[16,455,4,35],[16,456,4,35,"call"],[16,460,4,35],[16,461,4,35,"e"],[16,462,4,35],[16,464,4,35,"t"],[16,465,4,35],[16,472,4,35,"i"],[16,473,4,35],[16,477,4,35,"o"],[16,478,4,35],[16,481,4,35,"Object"],[16,487,4,35],[16,488,4,35,"defineProperty"],[16,502,4,35],[16,507,4,35,"Object"],[16,513,4,35],[16,514,4,35,"getOwnPropertyDescriptor"],[16,538,4,35],[16,539,4,35,"e"],[16,540,4,35],[16,542,4,35,"t"],[16,543,4,35],[16,550,4,35,"i"],[16,551,4,35],[16,552,4,35,"get"],[16,555,4,35],[16,559,4,35,"i"],[16,560,4,35],[16,561,4,35,"set"],[16,564,4,35],[16,568,4,35,"o"],[16,569,4,35],[16,570,4,35,"f"],[16,571,4,35],[16,573,4,35,"t"],[16,574,4,35],[16,576,4,35,"i"],[16,577,4,35],[16,581,4,35,"f"],[16,582,4,35],[16,583,4,35,"t"],[16,584,4,35],[16,588,4,35,"e"],[16,589,4,35],[16,590,4,35,"t"],[16,591,4,35],[16,602,4,35,"f"],[16,603,4,35],[16,608,4,35,"e"],[16,609,4,35],[16,611,4,35,"t"],[16,612,4,35],[17,2,21,0],[17,8,21,6,"AuthContext"],[17,19,21,17],[17,35,21,20],[17,39,21,20,"createContext"],[17,59,21,33],[17,61,21,63,"undefined"],[17,70,21,72],[17,71,21,73],[18,2,23,7],[18,8,23,13,"useAuth"],[18,15,23,20],[18,18,23,23,"useAuth"],[18,19,23,23],[18,24,23,29],[19,4,23,29,"_s"],[19,6,23,29],[20,4,24,2],[20,10,24,8,"context"],[20,17,24,15],[20,20,24,18],[20,24,24,18,"useContext"],[20,41,24,28],[20,43,24,29,"AuthContext"],[20,54,24,40],[20,55,24,41],[21,4,25,2],[21,8,25,6],[21,9,25,7,"context"],[21,16,25,14],[21,18,25,16],[22,6,26,4],[22,12,26,10],[22,16,26,14,"Error"],[22,21,26,19],[22,22,26,20],[22,67,26,65],[22,68,26,66],[23,4,27,2],[24,4,28,2],[24,11,28,9,"context"],[24,18,28,16],[25,2,29,0],[25,3,29,1],[26,2,29,2,"exports"],[26,9,29,2],[26,10,29,2,"useAuth"],[26,17,29,2],[26,20,29,2,"useAuth"],[26,27,29,2],[27,2,29,2,"_s"],[27,4,29,2],[27,5,23,13,"useAuth"],[27,12,23,20],[28,2,35,15],[28,11,35,24,"AuthProvider"],[28,23,35,36,"AuthProvider"],[28,24,35,37],[29,4,35,39,"children"],[30,2,35,67],[30,3,35,68],[30,5,35,70],[31,4,35,70,"_s2"],[31,7,35,70],[32,4,36,2],[32,10,36,8],[32,11,36,9,"user"],[32,15,36,13],[32,17,36,15,"setUser"],[32,24,36,22],[32,25,36,23],[32,28,36,26],[32,32,36,26,"useState"],[32,47,36,34],[32,49,36,48],[32,53,36,52],[32,54,36,53],[33,4,37,2],[33,10,37,8],[33,11,37,9,"isLoading"],[33,20,37,18],[33,22,37,20,"setIsLoading"],[33,34,37,32],[33,35,37,33],[33,38,37,36],[33,42,37,36,"useState"],[33,57,37,44],[33,59,37,45],[33,63,37,49],[33,64,37,50],[34,4,39,2],[34,10,39,8,"isAuthenticated"],[34,25,39,23],[34,28,39,26],[34,29,39,27],[34,30,39,28,"user"],[34,34,39,32],[35,4,41,2],[35,8,41,2,"useEffect"],[35,24,41,11],[35,26,41,12],[35,32,41,18],[36,6,42,4,"checkAuthStatus"],[36,21,42,19],[36,22,42,20],[36,23,42,21],[37,4,43,2],[37,5,43,3],[37,7,43,5],[37,9,43,7],[37,10,43,8],[38,4,45,2],[38,10,45,8,"checkAuthStatus"],[38,25,45,23],[38,28,45,26],[38,34,45,26,"checkAuthStatus"],[38,35,45,26],[38,40,45,38],[39,6,46,4],[39,10,46,8],[40,8,47,6],[40,14,47,12,"token"],[40,19,47,17],[40,22,47,20],[40,28,47,26,"AsyncStorage"],[40,49,47,38],[40,50,47,39,"getItem"],[40,57,47,46],[40,58,47,47],[40,70,47,59],[40,71,47,60],[41,8,48,6],[41,14,48,12,"userData"],[41,22,48,20],[41,25,48,23],[41,31,48,29,"AsyncStorage"],[41,52,48,41],[41,53,48,42,"getItem"],[41,60,48,49],[41,61,48,50],[41,72,48,61],[41,73,48,62],[42,8,50,6],[42,12,50,10,"token"],[42,17,50,15],[42,21,50,19,"userData"],[42,29,50,27],[42,31,50,29],[43,10,51,8],[43,16,51,14,"parsedUser"],[43,26,51,24],[43,29,51,27,"JSON"],[43,33,51,31],[43,34,51,32,"parse"],[43,39,51,37],[43,40,51,38,"userData"],[43,48,51,46],[43,49,51,47],[44,10,52,8,"setUser"],[44,17,52,15],[44,18,52,16],[45,12,52,18],[45,15,52,21,"parsedUser"],[45,25,52,31],[46,12,52,33,"token"],[47,10,52,39],[47,11,52,40],[47,12,52,41],[48,8,53,6],[48,9,53,7],[48,15,53,13],[49,10,54,8],[50,10,55,8],[50,16,55,14,"login"],[50,21,55,19],[50,22,55,20],[50,23,55,21],[51,8,56,6],[52,6,57,4],[52,7,57,5],[52,8,57,6],[52,15,57,13,"error"],[52,20,57,18],[52,22,57,20],[53,8,58,6,"console"],[53,15,58,13],[53,16,58,14,"log"],[53,19,58,17],[53,20,58,18],[53,39,58,37],[53,41,58,39,"error"],[53,46,58,44],[53,47,58,45],[54,8,59,6],[54,14,59,12,"login"],[54,19,59,17],[54,20,59,18],[54,21,59,19],[54,22,59,20],[54,23,59,21],[55,6,60,4],[55,7,60,5],[55,16,60,14],[56,8,61,6,"setIsLoading"],[56,20,61,18],[56,21,61,19],[56,26,61,24],[56,27,61,25],[57,6,62,4],[58,4,63,2],[58,5,63,3],[59,4,65,2],[59,10,65,8,"login"],[59,15,65,13],[59,18,65,16],[59,24,65,16,"login"],[59,25,65,16],[59,30,65,28],[60,6,66,4],[60,10,66,8],[61,8,67,6,"setIsLoading"],[61,20,67,18],[61,21,67,19],[61,25,67,23],[61,26,67,24],[62,8,69,6],[62,14,69,12,"response"],[62,22,69,20],[62,25,69,23],[62,31,69,29,"api"],[62,39,69,32],[62,40,69,33,"post"],[62,44,69,37],[62,45,69,38],[62,62,69,55],[62,64,69,57],[62,65,69,58],[62,66,69,59],[62,67,69,60],[63,8,71,6],[63,12,71,10],[63,13,71,11,"response"],[63,21,71,19],[63,22,71,20,"ok"],[63,24,71,22],[63,26,71,24],[64,10,72,8],[64,16,72,14],[64,20,72,18,"Error"],[64,25,72,23],[64,26,72,24],[64,59,72,57],[64,60,72,58],[65,8,73,6],[66,8,75,6],[66,14,75,12,"userData"],[66,22,75,20],[66,25,75,23],[66,31,75,29,"response"],[66,39,75,37],[66,40,75,38,"json"],[66,44,75,42],[66,45,75,43],[66,46,75,44],[67,8,77,6],[67,14,77,12,"AsyncStorage"],[67,35,77,24],[67,36,77,25,"setItem"],[67,43,77,32],[67,44,77,33],[67,56,77,45],[67,58,77,47,"userData"],[67,66,77,55],[67,67,77,56,"token"],[67,72,77,61],[67,73,77,62],[68,8,78,6],[68,14,78,12,"AsyncStorage"],[68,35,78,24],[68,36,78,25,"setItem"],[68,43,78,32],[68,44,78,33],[68,55,78,44],[68,57,78,46,"JSON"],[68,61,78,50],[68,62,78,51,"stringify"],[68,71,78,60],[68,72,78,61],[69,10,79,8,"id"],[69,12,79,10],[69,14,79,12,"userData"],[69,22,79,20],[69,23,79,21,"id"],[69,25,79,23],[70,10,80,8,"anonymous_id"],[70,22,80,20],[70,24,80,22,"userData"],[70,32,80,30],[70,33,80,31,"anonymous_id"],[70,45,80,43],[71,10,81,8,"display_name"],[71,22,81,20],[71,24,81,22,"userData"],[71,32,81,30],[71,33,81,31,"display_name"],[72,8,82,6],[72,9,82,7],[72,10,82,8],[72,11,82,9],[73,8,84,6,"setUser"],[73,15,84,13],[73,16,84,14,"userData"],[73,24,84,22],[73,25,84,23],[74,6,85,4],[74,7,85,5],[74,8,85,6],[74,15,85,13,"error"],[74,20,85,18],[74,22,85,20],[75,8,86,6,"console"],[75,15,86,13],[75,16,86,14,"error"],[75,21,86,19],[75,22,86,20],[75,36,86,34],[75,38,86,36,"error"],[75,43,86,41],[75,44,86,42],[76,8,87,6,"Alert"],[76,22,87,11],[76,23,87,12,"alert"],[76,28,87,17],[76,29,87,18],[76,37,87,26],[76,39,87,28],[76,70,87,59],[76,71,87,60],[77,6,88,4],[77,7,88,5],[77,16,88,14],[78,8,89,6,"setIsLoading"],[78,20,89,18],[78,21,89,19],[78,26,89,24],[78,27,89,25],[79,6,90,4],[80,4,91,2],[80,5,91,3],[81,4,93,2],[81,10,93,8,"logout"],[81,16,93,14],[81,19,93,17],[81,25,93,17,"logout"],[81,26,93,17],[81,31,93,29],[82,6,94,4],[82,10,94,8],[83,8,95,6],[83,14,95,12,"AsyncStorage"],[83,35,95,24],[83,36,95,25,"removeItem"],[83,46,95,35],[83,47,95,36],[83,59,95,48],[83,60,95,49],[84,8,96,6],[84,14,96,12,"AsyncStorage"],[84,35,96,24],[84,36,96,25,"removeItem"],[84,46,96,35],[84,47,96,36],[84,58,96,47],[84,59,96,48],[85,8,97,6,"setUser"],[85,15,97,13],[85,16,97,14],[85,20,97,18],[85,21,97,19],[87,8,99,6],[88,8,100,6],[88,14,100,12,"login"],[88,19,100,17],[88,20,100,18],[88,21,100,19],[89,6,101,4],[89,7,101,5],[89,8,101,6],[89,15,101,13,"error"],[89,20,101,18],[89,22,101,20],[90,8,102,6,"console"],[90,15,102,13],[90,16,102,14,"error"],[90,21,102,19],[90,22,102,20],[90,37,102,35],[90,39,102,37,"error"],[90,44,102,42],[90,45,102,43],[91,6,103,4],[92,4,104,2],[92,5,104,3],[93,4,106,2],[93,24,107,4],[93,28,107,4,"_jsxDevRuntime"],[93,42,107,4],[93,43,107,4,"jsxDEV"],[93,49,107,4],[93,51,107,5,"AuthContext"],[93,62,107,16],[93,63,107,17,"Provider"],[93,71,107,25],[94,6,107,26,"value"],[94,11,107,31],[94,13,107,33],[95,8,107,35,"user"],[95,12,107,39],[96,8,107,41,"isLoading"],[96,17,107,50],[97,8,107,52,"login"],[97,13,107,57],[98,8,107,59,"logout"],[98,14,107,65],[99,8,107,67,"isAuthenticated"],[100,6,107,83],[100,7,107,85],[101,6,107,85,"children"],[101,14,107,85],[101,16,108,7,"children"],[102,4,108,15],[103,6,108,15,"fileName"],[103,14,108,15],[103,16,108,15,"_jsxFileName"],[103,28,108,15],[104,6,108,15,"lineNumber"],[104,16,108,15],[105,6,108,15,"columnNumber"],[105,18,108,15],[106,4,108,15],[106,11,109,26],[106,12,109,27],[107,2,111,0],[108,2,111,1,"_s2"],[108,5,111,1],[108,6,35,24,"AuthProvider"],[108,18,35,36],[109,2,35,36,"_c"],[109,4,35,36],[109,7,35,24,"AuthProvider"],[109,19,35,36],[110,2,35,36],[110,6,35,36,"_c"],[110,8,35,36],[111,2,35,36,"$RefreshReg$"],[111,14,35,36],[111,15,35,36,"_c"],[111,17,35,36],[112,0,35,36],[112,3]],"functionMap":{"names":["<global>","useAuth","AuthProvider","useEffect$argument_0","checkAuthStatus","login","logout"],"mappings":"AAA;uBCsB;CDM;eEM;YCM;GDE;0BEE;GFkB;gBGE;GH0B;iBIE;GJW"}},"type":"js/module"}]}