{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"]}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"]}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/Alert","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"PEUC6jrQVoAGZ2qYkvimljMOyJI=","exportNames":["*"]}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = AuthProvider;\n  exports.useAuth = void 0;\n  var _env2 = require(_dependencyMap[1], \"expo/virtual/env\");\n  var _react = _interopRequireWildcard(require(_dependencyMap[2], \"react\"));\n  var _asyncStorage = _interopRequireDefault(require(_dependencyMap[3], \"@react-native-async-storage/async-storage\"));\n  var _Alert = _interopRequireDefault(require(_dependencyMap[4], \"react-native-web/dist/exports/Alert\"));\n  var _jsxDevRuntime = require(_dependencyMap[5], \"react/jsx-dev-runtime\");\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  function _interopRequireWildcard(e, t) { if (\"function\" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) \"default\" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const useAuth = () => {\n    _s();\n    const context = (0, _react.useContext)(AuthContext);\n    if (!context) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n  exports.useAuth = useAuth;\n  _s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  const API_BASE_URL = _env2.env.EXPO_PUBLIC_BACKEND_URL;\n  function AuthProvider({\n    children\n  }) {\n    _s2();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const isAuthenticated = !!user;\n    (0, _react.useEffect)(() => {\n      checkAuthStatus();\n    }, []);\n    const checkAuthStatus = async () => {\n      try {\n        const token = await _asyncStorage.default.getItem('auth_token');\n        const userData = await _asyncStorage.default.getItem('user_data');\n        if (token && userData) {\n          const parsedUser = JSON.parse(userData);\n          setUser({\n            ...parsedUser,\n            token\n          });\n        } else {\n          // Auto-login for anonymous users\n          await login();\n        }\n      } catch (error) {\n        console.log('Auth check error:', error);\n        await login(); // Fallback to anonymous login\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async () => {\n      try {\n        setIsLoading(true);\n        const response = await fetch(`${API_BASE_URL}/api/auth/anonymous`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        if (!response.ok) {\n          throw new Error('Failed to create anonymous user');\n        }\n        const userData = await response.json();\n        await _asyncStorage.default.setItem('auth_token', userData.token);\n        await _asyncStorage.default.setItem('user_data', JSON.stringify({\n          id: userData.id,\n          anonymous_id: userData.anonymous_id,\n          display_name: userData.display_name\n        }));\n        setUser(userData);\n      } catch (error) {\n        console.error('Login error:', error);\n        _Alert.default.alert('Ошибка', 'Не удалось войти в приложение');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        await _asyncStorage.default.removeItem('auth_token');\n        await _asyncStorage.default.removeItem('user_data');\n        setUser(null);\n\n        // Immediately create new anonymous user\n        await login();\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _jsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        isAuthenticated\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }, this);\n  }\n  _s2(AuthProvider, \"YajQB7LURzRD+QP5gw0+K2TZIWA=\");\n  _c = AuthProvider;\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":118,"map":[[9,2,1,0],[9,6,1,0,"_react"],[9,12,1,0],[9,15,1,0,"_interopRequireWildcard"],[9,38,1,0],[9,39,1,0,"require"],[9,46,1,0],[9,47,1,0,"_dependencyMap"],[9,61,1,0],[10,2,2,0],[10,6,2,0,"_asyncStorage"],[10,19,2,0],[10,22,2,0,"_interopRequireDefault"],[10,44,2,0],[10,45,2,0,"require"],[10,52,2,0],[10,53,2,0,"_dependencyMap"],[10,67,2,0],[11,2,2,69],[11,6,2,69,"_Alert"],[11,12,2,69],[11,15,2,69,"_interopRequireDefault"],[11,37,2,69],[11,38,2,69,"require"],[11,45,2,69],[11,46,2,69,"_dependencyMap"],[11,60,2,69],[12,2,2,69],[12,6,2,69,"_jsxDevRuntime"],[12,20,2,69],[12,23,2,69,"require"],[12,30,2,69],[12,31,2,69,"_dependencyMap"],[12,45,2,69],[13,2,2,69],[13,6,2,69,"_jsxFileName"],[13,18,2,69],[14,4,2,69,"_s"],[14,6,2,69],[14,9,2,69,"$RefreshSig$"],[14,21,2,69],[15,4,2,69,"_s2"],[15,7,2,69],[15,10,2,69,"$RefreshSig$"],[15,22,2,69],[16,2,2,69],[16,11,2,69,"_interopRequireWildcard"],[16,35,2,69,"e"],[16,36,2,69],[16,38,2,69,"t"],[16,39,2,69],[16,68,2,69,"WeakMap"],[16,75,2,69],[16,81,2,69,"r"],[16,82,2,69],[16,89,2,69,"WeakMap"],[16,96,2,69],[16,100,2,69,"n"],[16,101,2,69],[16,108,2,69,"WeakMap"],[16,115,2,69],[16,127,2,69,"_interopRequireWildcard"],[16,150,2,69],[16,162,2,69,"_interopRequireWildcard"],[16,163,2,69,"e"],[16,164,2,69],[16,166,2,69,"t"],[16,167,2,69],[16,176,2,69,"t"],[16,177,2,69],[16,181,2,69,"e"],[16,182,2,69],[16,186,2,69,"e"],[16,187,2,69],[16,188,2,69,"__esModule"],[16,198,2,69],[16,207,2,69,"e"],[16,208,2,69],[16,214,2,69,"o"],[16,215,2,69],[16,217,2,69,"i"],[16,218,2,69],[16,220,2,69,"f"],[16,221,2,69],[16,226,2,69,"__proto__"],[16,235,2,69],[16,243,2,69,"default"],[16,250,2,69],[16,252,2,69,"e"],[16,253,2,69],[16,270,2,69,"e"],[16,271,2,69],[16,294,2,69,"e"],[16,295,2,69],[16,320,2,69,"e"],[16,321,2,69],[16,330,2,69,"f"],[16,331,2,69],[16,337,2,69,"o"],[16,338,2,69],[16,341,2,69,"t"],[16,342,2,69],[16,345,2,69,"n"],[16,346,2,69],[16,349,2,69,"r"],[16,350,2,69],[16,358,2,69,"o"],[16,359,2,69],[16,360,2,69,"has"],[16,363,2,69],[16,364,2,69,"e"],[16,365,2,69],[16,375,2,69,"o"],[16,376,2,69],[16,377,2,69,"get"],[16,380,2,69],[16,381,2,69,"e"],[16,382,2,69],[16,385,2,69,"o"],[16,386,2,69],[16,387,2,69,"set"],[16,390,2,69],[16,391,2,69,"e"],[16,392,2,69],[16,394,2,69,"f"],[16,395,2,69],[16,411,2,69,"t"],[16,412,2,69],[16,416,2,69,"e"],[16,417,2,69],[16,433,2,69,"t"],[16,434,2,69],[16,441,2,69,"hasOwnProperty"],[16,455,2,69],[16,456,2,69,"call"],[16,460,2,69],[16,461,2,69,"e"],[16,462,2,69],[16,464,2,69,"t"],[16,465,2,69],[16,472,2,69,"i"],[16,473,2,69],[16,477,2,69,"o"],[16,478,2,69],[16,481,2,69,"Object"],[16,487,2,69],[16,488,2,69,"defineProperty"],[16,502,2,69],[16,507,2,69,"Object"],[16,513,2,69],[16,514,2,69,"getOwnPropertyDescriptor"],[16,538,2,69],[16,539,2,69,"e"],[16,540,2,69],[16,542,2,69,"t"],[16,543,2,69],[16,550,2,69,"i"],[16,551,2,69],[16,552,2,69,"get"],[16,555,2,69],[16,559,2,69,"i"],[16,560,2,69],[16,561,2,69,"set"],[16,564,2,69],[16,568,2,69,"o"],[16,569,2,69],[16,570,2,69,"f"],[16,571,2,69],[16,573,2,69,"t"],[16,574,2,69],[16,576,2,69,"i"],[16,577,2,69],[16,581,2,69,"f"],[16,582,2,69],[16,583,2,69,"t"],[16,584,2,69],[16,588,2,69,"e"],[16,589,2,69],[16,590,2,69,"t"],[16,591,2,69],[16,602,2,69,"f"],[16,603,2,69],[16,608,2,69,"e"],[16,609,2,69],[16,611,2,69,"t"],[16,612,2,69],[17,2,20,0],[17,8,20,6,"AuthContext"],[17,19,20,17],[17,35,20,20],[17,39,20,20,"createContext"],[17,59,20,33],[17,61,20,63,"undefined"],[17,70,20,72],[17,71,20,73],[18,2,22,7],[18,8,22,13,"useAuth"],[18,15,22,20],[18,18,22,23,"useAuth"],[18,19,22,23],[18,24,22,29],[19,4,22,29,"_s"],[19,6,22,29],[20,4,23,2],[20,10,23,8,"context"],[20,17,23,15],[20,20,23,18],[20,24,23,18,"useContext"],[20,41,23,28],[20,43,23,29,"AuthContext"],[20,54,23,40],[20,55,23,41],[21,4,24,2],[21,8,24,6],[21,9,24,7,"context"],[21,16,24,14],[21,18,24,16],[22,6,25,4],[22,12,25,10],[22,16,25,14,"Error"],[22,21,25,19],[22,22,25,20],[22,67,25,65],[22,68,25,66],[23,4,26,2],[24,4,27,2],[24,11,27,9,"context"],[24,18,27,16],[25,2,28,0],[25,3,28,1],[26,2,28,2,"exports"],[26,9,28,2],[26,10,28,2,"useAuth"],[26,17,28,2],[26,20,28,2,"useAuth"],[26,27,28,2],[27,2,28,2,"_s"],[27,4,28,2],[27,5,22,13,"useAuth"],[27,12,22,20],[28,2,34,0],[28,8,34,6,"API_BASE_URL"],[28,20,34,18],[28,23,34,18,"_env2"],[28,28,34,18],[28,29,34,18,"env"],[28,32,34,18],[28,33,34,18,"EXPO_PUBLIC_BACKEND_URL"],[28,56,34,56],[29,2,36,15],[29,11,36,24,"AuthProvider"],[29,23,36,36,"AuthProvider"],[29,24,36,37],[30,4,36,39,"children"],[31,2,36,67],[31,3,36,68],[31,5,36,70],[32,4,36,70,"_s2"],[32,7,36,70],[33,4,37,2],[33,10,37,8],[33,11,37,9,"user"],[33,15,37,13],[33,17,37,15,"setUser"],[33,24,37,22],[33,25,37,23],[33,28,37,26],[33,32,37,26,"useState"],[33,47,37,34],[33,49,37,48],[33,53,37,52],[33,54,37,53],[34,4,38,2],[34,10,38,8],[34,11,38,9,"isLoading"],[34,20,38,18],[34,22,38,20,"setIsLoading"],[34,34,38,32],[34,35,38,33],[34,38,38,36],[34,42,38,36,"useState"],[34,57,38,44],[34,59,38,45],[34,63,38,49],[34,64,38,50],[35,4,40,2],[35,10,40,8,"isAuthenticated"],[35,25,40,23],[35,28,40,26],[35,29,40,27],[35,30,40,28,"user"],[35,34,40,32],[36,4,42,2],[36,8,42,2,"useEffect"],[36,24,42,11],[36,26,42,12],[36,32,42,18],[37,6,43,4,"checkAuthStatus"],[37,21,43,19],[37,22,43,20],[37,23,43,21],[38,4,44,2],[38,5,44,3],[38,7,44,5],[38,9,44,7],[38,10,44,8],[39,4,46,2],[39,10,46,8,"checkAuthStatus"],[39,25,46,23],[39,28,46,26],[39,34,46,26,"checkAuthStatus"],[39,35,46,26],[39,40,46,38],[40,6,47,4],[40,10,47,8],[41,8,48,6],[41,14,48,12,"token"],[41,19,48,17],[41,22,48,20],[41,28,48,26,"AsyncStorage"],[41,49,48,38],[41,50,48,39,"getItem"],[41,57,48,46],[41,58,48,47],[41,70,48,59],[41,71,48,60],[42,8,49,6],[42,14,49,12,"userData"],[42,22,49,20],[42,25,49,23],[42,31,49,29,"AsyncStorage"],[42,52,49,41],[42,53,49,42,"getItem"],[42,60,49,49],[42,61,49,50],[42,72,49,61],[42,73,49,62],[43,8,51,6],[43,12,51,10,"token"],[43,17,51,15],[43,21,51,19,"userData"],[43,29,51,27],[43,31,51,29],[44,10,52,8],[44,16,52,14,"parsedUser"],[44,26,52,24],[44,29,52,27,"JSON"],[44,33,52,31],[44,34,52,32,"parse"],[44,39,52,37],[44,40,52,38,"userData"],[44,48,52,46],[44,49,52,47],[45,10,53,8,"setUser"],[45,17,53,15],[45,18,53,16],[46,12,53,18],[46,15,53,21,"parsedUser"],[46,25,53,31],[47,12,53,33,"token"],[48,10,53,39],[48,11,53,40],[48,12,53,41],[49,8,54,6],[49,9,54,7],[49,15,54,13],[50,10,55,8],[51,10,56,8],[51,16,56,14,"login"],[51,21,56,19],[51,22,56,20],[51,23,56,21],[52,8,57,6],[53,6,58,4],[53,7,58,5],[53,8,58,6],[53,15,58,13,"error"],[53,20,58,18],[53,22,58,20],[54,8,59,6,"console"],[54,15,59,13],[54,16,59,14,"log"],[54,19,59,17],[54,20,59,18],[54,39,59,37],[54,41,59,39,"error"],[54,46,59,44],[54,47,59,45],[55,8,60,6],[55,14,60,12,"login"],[55,19,60,17],[55,20,60,18],[55,21,60,19],[55,22,60,20],[55,23,60,21],[56,6,61,4],[56,7,61,5],[56,16,61,14],[57,8,62,6,"setIsLoading"],[57,20,62,18],[57,21,62,19],[57,26,62,24],[57,27,62,25],[58,6,63,4],[59,4,64,2],[59,5,64,3],[60,4,66,2],[60,10,66,8,"login"],[60,15,66,13],[60,18,66,16],[60,24,66,16,"login"],[60,25,66,16],[60,30,66,28],[61,6,67,4],[61,10,67,8],[62,8,68,6,"setIsLoading"],[62,20,68,18],[62,21,68,19],[62,25,68,23],[62,26,68,24],[63,8,70,6],[63,14,70,12,"response"],[63,22,70,20],[63,25,70,23],[63,31,70,29,"fetch"],[63,36,70,34],[63,37,70,35],[63,40,70,38,"API_BASE_URL"],[63,52,70,50],[63,73,70,71],[63,75,70,73],[64,10,71,8,"method"],[64,16,71,14],[64,18,71,16],[64,24,71,22],[65,10,72,8,"headers"],[65,17,72,15],[65,19,72,17],[66,12,73,10],[66,26,73,24],[66,28,73,26],[67,10,74,8],[68,8,75,6],[68,9,75,7],[68,10,75,8],[69,8,77,6],[69,12,77,10],[69,13,77,11,"response"],[69,21,77,19],[69,22,77,20,"ok"],[69,24,77,22],[69,26,77,24],[70,10,78,8],[70,16,78,14],[70,20,78,18,"Error"],[70,25,78,23],[70,26,78,24],[70,59,78,57],[70,60,78,58],[71,8,79,6],[72,8,81,6],[72,14,81,12,"userData"],[72,22,81,20],[72,25,81,23],[72,31,81,29,"response"],[72,39,81,37],[72,40,81,38,"json"],[72,44,81,42],[72,45,81,43],[72,46,81,44],[73,8,83,6],[73,14,83,12,"AsyncStorage"],[73,35,83,24],[73,36,83,25,"setItem"],[73,43,83,32],[73,44,83,33],[73,56,83,45],[73,58,83,47,"userData"],[73,66,83,55],[73,67,83,56,"token"],[73,72,83,61],[73,73,83,62],[74,8,84,6],[74,14,84,12,"AsyncStorage"],[74,35,84,24],[74,36,84,25,"setItem"],[74,43,84,32],[74,44,84,33],[74,55,84,44],[74,57,84,46,"JSON"],[74,61,84,50],[74,62,84,51,"stringify"],[74,71,84,60],[74,72,84,61],[75,10,85,8,"id"],[75,12,85,10],[75,14,85,12,"userData"],[75,22,85,20],[75,23,85,21,"id"],[75,25,85,23],[76,10,86,8,"anonymous_id"],[76,22,86,20],[76,24,86,22,"userData"],[76,32,86,30],[76,33,86,31,"anonymous_id"],[76,45,86,43],[77,10,87,8,"display_name"],[77,22,87,20],[77,24,87,22,"userData"],[77,32,87,30],[77,33,87,31,"display_name"],[78,8,88,6],[78,9,88,7],[78,10,88,8],[78,11,88,9],[79,8,90,6,"setUser"],[79,15,90,13],[79,16,90,14,"userData"],[79,24,90,22],[79,25,90,23],[80,6,91,4],[80,7,91,5],[80,8,91,6],[80,15,91,13,"error"],[80,20,91,18],[80,22,91,20],[81,8,92,6,"console"],[81,15,92,13],[81,16,92,14,"error"],[81,21,92,19],[81,22,92,20],[81,36,92,34],[81,38,92,36,"error"],[81,43,92,41],[81,44,92,42],[82,8,93,6,"Alert"],[82,22,93,11],[82,23,93,12,"alert"],[82,28,93,17],[82,29,93,18],[82,37,93,26],[82,39,93,28],[82,70,93,59],[82,71,93,60],[83,6,94,4],[83,7,94,5],[83,16,94,14],[84,8,95,6,"setIsLoading"],[84,20,95,18],[84,21,95,19],[84,26,95,24],[84,27,95,25],[85,6,96,4],[86,4,97,2],[86,5,97,3],[87,4,99,2],[87,10,99,8,"logout"],[87,16,99,14],[87,19,99,17],[87,25,99,17,"logout"],[87,26,99,17],[87,31,99,29],[88,6,100,4],[88,10,100,8],[89,8,101,6],[89,14,101,12,"AsyncStorage"],[89,35,101,24],[89,36,101,25,"removeItem"],[89,46,101,35],[89,47,101,36],[89,59,101,48],[89,60,101,49],[90,8,102,6],[90,14,102,12,"AsyncStorage"],[90,35,102,24],[90,36,102,25,"removeItem"],[90,46,102,35],[90,47,102,36],[90,58,102,47],[90,59,102,48],[91,8,103,6,"setUser"],[91,15,103,13],[91,16,103,14],[91,20,103,18],[91,21,103,19],[93,8,105,6],[94,8,106,6],[94,14,106,12,"login"],[94,19,106,17],[94,20,106,18],[94,21,106,19],[95,6,107,4],[95,7,107,5],[95,8,107,6],[95,15,107,13,"error"],[95,20,107,18],[95,22,107,20],[96,8,108,6,"console"],[96,15,108,13],[96,16,108,14,"error"],[96,21,108,19],[96,22,108,20],[96,37,108,35],[96,39,108,37,"error"],[96,44,108,42],[96,45,108,43],[97,6,109,4],[98,4,110,2],[98,5,110,3],[99,4,112,2],[99,24,113,4],[99,28,113,4,"_jsxDevRuntime"],[99,42,113,4],[99,43,113,4,"jsxDEV"],[99,49,113,4],[99,51,113,5,"AuthContext"],[99,62,113,16],[99,63,113,17,"Provider"],[99,71,113,25],[100,6,113,26,"value"],[100,11,113,31],[100,13,113,33],[101,8,113,35,"user"],[101,12,113,39],[102,8,113,41,"isLoading"],[102,17,113,50],[103,8,113,52,"login"],[103,13,113,57],[104,8,113,59,"logout"],[104,14,113,65],[105,8,113,67,"isAuthenticated"],[106,6,113,83],[106,7,113,85],[107,6,113,85,"children"],[107,14,113,85],[107,16,114,7,"children"],[108,4,114,15],[109,6,114,15,"fileName"],[109,14,114,15],[109,16,114,15,"_jsxFileName"],[109,28,114,15],[110,6,114,15,"lineNumber"],[110,16,114,15],[111,6,114,15,"columnNumber"],[111,18,114,15],[112,4,114,15],[112,11,115,26],[112,12,115,27],[113,2,117,0],[114,2,117,1,"_s2"],[114,5,117,1],[114,6,36,24,"AuthProvider"],[114,18,36,36],[115,2,36,36,"_c"],[115,4,36,36],[115,7,36,24,"AuthProvider"],[115,19,36,36],[116,2,36,36],[116,6,36,36,"_c"],[116,8,36,36],[117,2,36,36,"$RefreshReg$"],[117,14,36,36],[117,15,36,36,"_c"],[117,17,36,36],[118,0,36,36],[118,3]],"functionMap":{"names":["<global>","useAuth","AuthProvider","useEffect$argument_0","checkAuthStatus","login","logout"],"mappings":"AAA;uBCqB;CDM;eEQ;YCM;GDE;0BEE;GFkB;gBGE;GH+B;iBIE;GJW"}},"type":"js/module"}]}