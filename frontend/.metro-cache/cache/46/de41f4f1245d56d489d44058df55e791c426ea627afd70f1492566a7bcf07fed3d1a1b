{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"]}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/Alert","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"PEUC6jrQVoAGZ2qYkvimljMOyJI=","exportNames":["*"]}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":198},"end":{"line":4,"column":35,"index":233}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"]}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = AuthProvider;\n  exports.useAuth = void 0;\n  var _react = _interopRequireWildcard(require(_dependencyMap[1], \"react\"));\n  var _asyncStorage = _interopRequireDefault(require(_dependencyMap[2], \"@react-native-async-storage/async-storage\"));\n  var _Alert = _interopRequireDefault(require(_dependencyMap[3], \"react-native-web/dist/exports/Alert\"));\n  var _api = require(_dependencyMap[4], \"../utils/api\");\n  var _jsxDevRuntime = require(_dependencyMap[5], \"react/jsx-dev-runtime\");\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  function _interopRequireWildcard(e, t) { if (\"function\" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) \"default\" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const useAuth = () => {\n    _s();\n    const context = (0, _react.useContext)(AuthContext);\n    if (!context) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n  exports.useAuth = useAuth;\n  _s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  function AuthProvider({\n    children\n  }) {\n    _s2();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const isAuthenticated = !!user;\n    (0, _react.useEffect)(() => {\n      checkAuthStatus();\n    }, []);\n    const checkAuthStatus = async () => {\n      try {\n        const token = await _asyncStorage.default.getItem('auth_token');\n        const userData = await _asyncStorage.default.getItem('user_data');\n        if (token && userData) {\n          const parsedUser = JSON.parse(userData);\n          setUser(Object.assign({}, parsedUser, {\n            token\n          }));\n        } else {\n          // Auto-login for anonymous users\n          await login();\n        }\n      } catch (error) {\n        console.log('Auth check error:', error);\n        await login(); // Fallback to anonymous login\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async () => {\n      try {\n        setIsLoading(true);\n        const response = await _api.api.post('/auth/anonymous', {});\n        if (!response.ok) {\n          throw new Error('Failed to create anonymous user');\n        }\n        const userData = await response.json();\n        await _asyncStorage.default.setItem('auth_token', userData.token);\n        await _asyncStorage.default.setItem('user_data', JSON.stringify({\n          id: userData.id,\n          anonymous_id: userData.anonymous_id,\n          display_name: userData.display_name\n        }));\n        setUser(userData);\n      } catch (error) {\n        console.error('Login error:', error);\n        _Alert.default.alert('Ошибка', 'Не удалось войти в приложение');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        await _asyncStorage.default.removeItem('auth_token');\n        await _asyncStorage.default.removeItem('user_data');\n        setUser(null);\n\n        // Immediately create new anonymous user\n        await login();\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _jsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        isAuthenticated\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 5\n    }, this);\n  }\n  _s2(AuthProvider, \"YajQB7LURzRD+QP5gw0+K2TZIWA=\");\n  _c = AuthProvider;\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":111,"map":[[8,2,1,0],[8,6,1,0,"_react"],[8,12,1,0],[8,15,1,0,"_interopRequireWildcard"],[8,38,1,0],[8,39,1,0,"require"],[8,46,1,0],[8,47,1,0,"_dependencyMap"],[8,61,1,0],[9,2,2,0],[9,6,2,0,"_asyncStorage"],[9,19,2,0],[9,22,2,0,"_interopRequireDefault"],[9,44,2,0],[9,45,2,0,"require"],[9,52,2,0],[9,53,2,0,"_dependencyMap"],[9,67,2,0],[10,2,2,69],[10,6,2,69,"_Alert"],[10,12,2,69],[10,15,2,69,"_interopRequireDefault"],[10,37,2,69],[10,38,2,69,"require"],[10,45,2,69],[10,46,2,69,"_dependencyMap"],[10,60,2,69],[11,2,4,0],[11,6,4,0,"_api"],[11,10,4,0],[11,13,4,0,"require"],[11,20,4,0],[11,21,4,0,"_dependencyMap"],[11,35,4,0],[12,2,4,35],[12,6,4,35,"_jsxDevRuntime"],[12,20,4,35],[12,23,4,35,"require"],[12,30,4,35],[12,31,4,35,"_dependencyMap"],[12,45,4,35],[13,2,4,35],[13,6,4,35,"_jsxFileName"],[13,18,4,35],[14,4,4,35,"_s"],[14,6,4,35],[14,9,4,35,"$RefreshSig$"],[14,21,4,35],[15,4,4,35,"_s2"],[15,7,4,35],[15,10,4,35,"$RefreshSig$"],[15,22,4,35],[16,2,4,35],[16,11,4,35,"_interopRequireWildcard"],[16,35,4,35,"e"],[16,36,4,35],[16,38,4,35,"t"],[16,39,4,35],[16,68,4,35,"WeakMap"],[16,75,4,35],[16,81,4,35,"r"],[16,82,4,35],[16,89,4,35,"WeakMap"],[16,96,4,35],[16,100,4,35,"n"],[16,101,4,35],[16,108,4,35,"WeakMap"],[16,115,4,35],[16,127,4,35,"_interopRequireWildcard"],[16,150,4,35],[16,162,4,35,"_interopRequireWildcard"],[16,163,4,35,"e"],[16,164,4,35],[16,166,4,35,"t"],[16,167,4,35],[16,176,4,35,"t"],[16,177,4,35],[16,181,4,35,"e"],[16,182,4,35],[16,186,4,35,"e"],[16,187,4,35],[16,188,4,35,"__esModule"],[16,198,4,35],[16,207,4,35,"e"],[16,208,4,35],[16,214,4,35,"o"],[16,215,4,35],[16,217,4,35,"i"],[16,218,4,35],[16,220,4,35,"f"],[16,221,4,35],[16,226,4,35,"__proto__"],[16,235,4,35],[16,243,4,35,"default"],[16,250,4,35],[16,252,4,35,"e"],[16,253,4,35],[16,270,4,35,"e"],[16,271,4,35],[16,294,4,35,"e"],[16,295,4,35],[16,320,4,35,"e"],[16,321,4,35],[16,330,4,35,"f"],[16,331,4,35],[16,337,4,35,"o"],[16,338,4,35],[16,341,4,35,"t"],[16,342,4,35],[16,345,4,35,"n"],[16,346,4,35],[16,349,4,35,"r"],[16,350,4,35],[16,358,4,35,"o"],[16,359,4,35],[16,360,4,35,"has"],[16,363,4,35],[16,364,4,35,"e"],[16,365,4,35],[16,375,4,35,"o"],[16,376,4,35],[16,377,4,35,"get"],[16,380,4,35],[16,381,4,35,"e"],[16,382,4,35],[16,385,4,35,"o"],[16,386,4,35],[16,387,4,35,"set"],[16,390,4,35],[16,391,4,35,"e"],[16,392,4,35],[16,394,4,35,"f"],[16,395,4,35],[16,411,4,35,"t"],[16,412,4,35],[16,416,4,35,"e"],[16,417,4,35],[16,433,4,35,"t"],[16,434,4,35],[16,441,4,35,"hasOwnProperty"],[16,455,4,35],[16,456,4,35,"call"],[16,460,4,35],[16,461,4,35,"e"],[16,462,4,35],[16,464,4,35,"t"],[16,465,4,35],[16,472,4,35,"i"],[16,473,4,35],[16,477,4,35,"o"],[16,478,4,35],[16,481,4,35,"Object"],[16,487,4,35],[16,488,4,35,"defineProperty"],[16,502,4,35],[16,507,4,35,"Object"],[16,513,4,35],[16,514,4,35,"getOwnPropertyDescriptor"],[16,538,4,35],[16,539,4,35,"e"],[16,540,4,35],[16,542,4,35,"t"],[16,543,4,35],[16,550,4,35,"i"],[16,551,4,35],[16,552,4,35,"get"],[16,555,4,35],[16,559,4,35,"i"],[16,560,4,35],[16,561,4,35,"set"],[16,564,4,35],[16,568,4,35,"o"],[16,569,4,35],[16,570,4,35,"f"],[16,571,4,35],[16,573,4,35,"t"],[16,574,4,35],[16,576,4,35,"i"],[16,577,4,35],[16,581,4,35,"f"],[16,582,4,35],[16,583,4,35,"t"],[16,584,4,35],[16,588,4,35,"e"],[16,589,4,35],[16,590,4,35,"t"],[16,591,4,35],[16,602,4,35,"f"],[16,603,4,35],[16,608,4,35,"e"],[16,609,4,35],[16,611,4,35,"t"],[16,612,4,35],[17,2,21,0],[17,8,21,6,"AuthContext"],[17,19,21,17],[17,35,21,20],[17,39,21,20,"createContext"],[17,59,21,33],[17,61,21,63,"undefined"],[17,70,21,72],[17,71,21,73],[18,2,23,7],[18,8,23,13,"useAuth"],[18,15,23,20],[18,18,23,23,"useAuth"],[18,19,23,23],[18,24,23,29],[19,4,23,29,"_s"],[19,6,23,29],[20,4,24,2],[20,10,24,8,"context"],[20,17,24,15],[20,20,24,18],[20,24,24,18,"useContext"],[20,41,24,28],[20,43,24,29,"AuthContext"],[20,54,24,40],[20,55,24,41],[21,4,25,2],[21,8,25,6],[21,9,25,7,"context"],[21,16,25,14],[21,18,25,16],[22,6,26,4],[22,12,26,10],[22,16,26,14,"Error"],[22,21,26,19],[22,22,26,20],[22,67,26,65],[22,68,26,66],[23,4,27,2],[24,4,28,2],[24,11,28,9,"context"],[24,18,28,16],[25,2,29,0],[25,3,29,1],[26,2,29,2,"exports"],[26,9,29,2],[26,10,29,2,"useAuth"],[26,17,29,2],[26,20,29,2,"useAuth"],[26,27,29,2],[27,2,29,2,"_s"],[27,4,29,2],[27,5,23,13,"useAuth"],[27,12,23,20],[28,2,35,15],[28,11,35,24,"AuthProvider"],[28,23,35,36,"AuthProvider"],[28,24,35,37],[29,4,35,39,"children"],[30,2,35,67],[30,3,35,68],[30,5,35,70],[31,4,35,70,"_s2"],[31,7,35,70],[32,4,36,2],[32,10,36,8],[32,11,36,9,"user"],[32,15,36,13],[32,17,36,15,"setUser"],[32,24,36,22],[32,25,36,23],[32,28,36,26],[32,32,36,26,"useState"],[32,47,36,34],[32,49,36,48],[32,53,36,52],[32,54,36,53],[33,4,37,2],[33,10,37,8],[33,11,37,9,"isLoading"],[33,20,37,18],[33,22,37,20,"setIsLoading"],[33,34,37,32],[33,35,37,33],[33,38,37,36],[33,42,37,36,"useState"],[33,57,37,44],[33,59,37,45],[33,63,37,49],[33,64,37,50],[34,4,39,2],[34,10,39,8,"isAuthenticated"],[34,25,39,23],[34,28,39,26],[34,29,39,27],[34,30,39,28,"user"],[34,34,39,32],[35,4,41,2],[35,8,41,2,"useEffect"],[35,24,41,11],[35,26,41,12],[35,32,41,18],[36,6,42,4,"checkAuthStatus"],[36,21,42,19],[36,22,42,20],[36,23,42,21],[37,4,43,2],[37,5,43,3],[37,7,43,5],[37,9,43,7],[37,10,43,8],[38,4,45,2],[38,10,45,8,"checkAuthStatus"],[38,25,45,23],[38,28,45,26],[38,34,45,26,"checkAuthStatus"],[38,35,45,26],[38,40,45,38],[39,6,46,4],[39,10,46,8],[40,8,47,6],[40,14,47,12,"token"],[40,19,47,17],[40,22,47,20],[40,28,47,26,"AsyncStorage"],[40,49,47,38],[40,50,47,39,"getItem"],[40,57,47,46],[40,58,47,47],[40,70,47,59],[40,71,47,60],[41,8,48,6],[41,14,48,12,"userData"],[41,22,48,20],[41,25,48,23],[41,31,48,29,"AsyncStorage"],[41,52,48,41],[41,53,48,42,"getItem"],[41,60,48,49],[41,61,48,50],[41,72,48,61],[41,73,48,62],[42,8,50,6],[42,12,50,10,"token"],[42,17,50,15],[42,21,50,19,"userData"],[42,29,50,27],[42,31,50,29],[43,10,51,8],[43,16,51,14,"parsedUser"],[43,26,51,24],[43,29,51,27,"JSON"],[43,33,51,31],[43,34,51,32,"parse"],[43,39,51,37],[43,40,51,38,"userData"],[43,48,51,46],[43,49,51,47],[44,10,52,8,"setUser"],[44,17,52,15],[44,18,52,15,"Object"],[44,24,52,15],[44,25,52,15,"assign"],[44,31,52,15],[44,36,52,21,"parsedUser"],[44,46,52,31],[45,12,52,33,"token"],[46,10,52,38],[46,12,52,40],[46,13,52,41],[47,8,53,6],[47,9,53,7],[47,15,53,13],[48,10,54,8],[49,10,55,8],[49,16,55,14,"login"],[49,21,55,19],[49,22,55,20],[49,23,55,21],[50,8,56,6],[51,6,57,4],[51,7,57,5],[51,8,57,6],[51,15,57,13,"error"],[51,20,57,18],[51,22,57,20],[52,8,58,6,"console"],[52,15,58,13],[52,16,58,14,"log"],[52,19,58,17],[52,20,58,18],[52,39,58,37],[52,41,58,39,"error"],[52,46,58,44],[52,47,58,45],[53,8,59,6],[53,14,59,12,"login"],[53,19,59,17],[53,20,59,18],[53,21,59,19],[53,22,59,20],[53,23,59,21],[54,6,60,4],[54,7,60,5],[54,16,60,14],[55,8,61,6,"setIsLoading"],[55,20,61,18],[55,21,61,19],[55,26,61,24],[55,27,61,25],[56,6,62,4],[57,4,63,2],[57,5,63,3],[58,4,65,2],[58,10,65,8,"login"],[58,15,65,13],[58,18,65,16],[58,24,65,16,"login"],[58,25,65,16],[58,30,65,28],[59,6,66,4],[59,10,66,8],[60,8,67,6,"setIsLoading"],[60,20,67,18],[60,21,67,19],[60,25,67,23],[60,26,67,24],[61,8,69,6],[61,14,69,12,"response"],[61,22,69,20],[61,25,69,23],[61,31,69,29,"api"],[61,39,69,32],[61,40,69,33,"post"],[61,44,69,37],[61,45,69,38],[61,62,69,55],[61,64,69,57],[61,65,69,58],[61,66,69,59],[61,67,69,60],[62,8,71,6],[62,12,71,10],[62,13,71,11,"response"],[62,21,71,19],[62,22,71,20,"ok"],[62,24,71,22],[62,26,71,24],[63,10,72,8],[63,16,72,14],[63,20,72,18,"Error"],[63,25,72,23],[63,26,72,24],[63,59,72,57],[63,60,72,58],[64,8,73,6],[65,8,75,6],[65,14,75,12,"userData"],[65,22,75,20],[65,25,75,23],[65,31,75,29,"response"],[65,39,75,37],[65,40,75,38,"json"],[65,44,75,42],[65,45,75,43],[65,46,75,44],[66,8,77,6],[66,14,77,12,"AsyncStorage"],[66,35,77,24],[66,36,77,25,"setItem"],[66,43,77,32],[66,44,77,33],[66,56,77,45],[66,58,77,47,"userData"],[66,66,77,55],[66,67,77,56,"token"],[66,72,77,61],[66,73,77,62],[67,8,78,6],[67,14,78,12,"AsyncStorage"],[67,35,78,24],[67,36,78,25,"setItem"],[67,43,78,32],[67,44,78,33],[67,55,78,44],[67,57,78,46,"JSON"],[67,61,78,50],[67,62,78,51,"stringify"],[67,71,78,60],[67,72,78,61],[68,10,79,8,"id"],[68,12,79,10],[68,14,79,12,"userData"],[68,22,79,20],[68,23,79,21,"id"],[68,25,79,23],[69,10,80,8,"anonymous_id"],[69,22,80,20],[69,24,80,22,"userData"],[69,32,80,30],[69,33,80,31,"anonymous_id"],[69,45,80,43],[70,10,81,8,"display_name"],[70,22,81,20],[70,24,81,22,"userData"],[70,32,81,30],[70,33,81,31,"display_name"],[71,8,82,6],[71,9,82,7],[71,10,82,8],[71,11,82,9],[72,8,84,6,"setUser"],[72,15,84,13],[72,16,84,14,"userData"],[72,24,84,22],[72,25,84,23],[73,6,85,4],[73,7,85,5],[73,8,85,6],[73,15,85,13,"error"],[73,20,85,18],[73,22,85,20],[74,8,86,6,"console"],[74,15,86,13],[74,16,86,14,"error"],[74,21,86,19],[74,22,86,20],[74,36,86,34],[74,38,86,36,"error"],[74,43,86,41],[74,44,86,42],[75,8,87,6,"Alert"],[75,22,87,11],[75,23,87,12,"alert"],[75,28,87,17],[75,29,87,18],[75,37,87,26],[75,39,87,28],[75,70,87,59],[75,71,87,60],[76,6,88,4],[76,7,88,5],[76,16,88,14],[77,8,89,6,"setIsLoading"],[77,20,89,18],[77,21,89,19],[77,26,89,24],[77,27,89,25],[78,6,90,4],[79,4,91,2],[79,5,91,3],[80,4,93,2],[80,10,93,8,"logout"],[80,16,93,14],[80,19,93,17],[80,25,93,17,"logout"],[80,26,93,17],[80,31,93,29],[81,6,94,4],[81,10,94,8],[82,8,95,6],[82,14,95,12,"AsyncStorage"],[82,35,95,24],[82,36,95,25,"removeItem"],[82,46,95,35],[82,47,95,36],[82,59,95,48],[82,60,95,49],[83,8,96,6],[83,14,96,12,"AsyncStorage"],[83,35,96,24],[83,36,96,25,"removeItem"],[83,46,96,35],[83,47,96,36],[83,58,96,47],[83,59,96,48],[84,8,97,6,"setUser"],[84,15,97,13],[84,16,97,14],[84,20,97,18],[84,21,97,19],[86,8,99,6],[87,8,100,6],[87,14,100,12,"login"],[87,19,100,17],[87,20,100,18],[87,21,100,19],[88,6,101,4],[88,7,101,5],[88,8,101,6],[88,15,101,13,"error"],[88,20,101,18],[88,22,101,20],[89,8,102,6,"console"],[89,15,102,13],[89,16,102,14,"error"],[89,21,102,19],[89,22,102,20],[89,37,102,35],[89,39,102,37,"error"],[89,44,102,42],[89,45,102,43],[90,6,103,4],[91,4,104,2],[91,5,104,3],[92,4,106,2],[92,24,107,4],[92,28,107,4,"_jsxDevRuntime"],[92,42,107,4],[92,43,107,4,"jsxDEV"],[92,49,107,4],[92,51,107,5,"AuthContext"],[92,62,107,16],[92,63,107,17,"Provider"],[92,71,107,25],[93,6,107,26,"value"],[93,11,107,31],[93,13,107,33],[94,8,107,35,"user"],[94,12,107,39],[95,8,107,41,"isLoading"],[95,17,107,50],[96,8,107,52,"login"],[96,13,107,57],[97,8,107,59,"logout"],[97,14,107,65],[98,8,107,67,"isAuthenticated"],[99,6,107,83],[99,7,107,85],[100,6,107,85,"children"],[100,14,107,85],[100,16,108,7,"children"],[101,4,108,15],[102,6,108,15,"fileName"],[102,14,108,15],[102,16,108,15,"_jsxFileName"],[102,28,108,15],[103,6,108,15,"lineNumber"],[103,16,108,15],[104,6,108,15,"columnNumber"],[104,18,108,15],[105,4,108,15],[105,11,109,26],[105,12,109,27],[106,2,111,0],[107,2,111,1,"_s2"],[107,5,111,1],[107,6,35,24,"AuthProvider"],[107,18,35,36],[108,2,35,36,"_c"],[108,4,35,36],[108,7,35,24,"AuthProvider"],[108,19,35,36],[109,2,35,36],[109,6,35,36,"_c"],[109,8,35,36],[110,2,35,36,"$RefreshReg$"],[110,14,35,36],[110,15,35,36,"_c"],[110,17,35,36],[111,0,35,36],[111,3]],"functionMap":{"names":["<global>","useAuth","AuthProvider","useEffect$argument_0","checkAuthStatus","login","logout"],"mappings":"AAA;uBCsB;CDM;eEM;YCM;GDE;0BEE;GFkB;gBGE;GH0B;iBIE;GJW"}},"type":"js/module"}]}