{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"]}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/Alert","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"PEUC6jrQVoAGZ2qYkvimljMOyJI=","exportNames":["*"]}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":198},"end":{"line":4,"column":35,"index":233}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"]}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = AuthProvider;\n  exports.useAuth = void 0;\n  var _react = _interopRequireWildcard(require(_dependencyMap[1], \"react\"));\n  var _asyncStorage = _interopRequireDefault(require(_dependencyMap[2], \"@react-native-async-storage/async-storage\"));\n  var _Alert = _interopRequireDefault(require(_dependencyMap[3], \"react-native-web/dist/exports/Alert\"));\n  var _api = require(_dependencyMap[4], \"../utils/api\");\n  var _jsxDevRuntime = require(_dependencyMap[5], \"react/jsx-dev-runtime\");\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\";\n  function _interopRequireWildcard(e, t) { if (\"function\" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) \"default\" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const useAuth = () => {\n    const context = (0, _react.useContext)(AuthContext);\n    if (!context) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n  exports.useAuth = useAuth;\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const isAuthenticated = !!user;\n    (0, _react.useEffect)(() => {\n      checkAuthStatus();\n    }, []);\n    const checkAuthStatus = async () => {\n      try {\n        const token = await _asyncStorage.default.getItem('auth_token');\n        const userData = await _asyncStorage.default.getItem('user_data');\n        if (token && userData) {\n          const parsedUser = JSON.parse(userData);\n          setUser({\n            ...parsedUser,\n            token\n          });\n        } else {\n          // Auto-login for anonymous users\n          await login();\n        }\n      } catch (error) {\n        console.log('Auth check error:', error);\n        await login(); // Fallback to anonymous login\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async () => {\n      try {\n        setIsLoading(true);\n        const response = await _api.api.post('/auth/anonymous', {});\n        if (!response.ok) {\n          throw new Error('Failed to create anonymous user');\n        }\n        const userData = await response.json();\n        await _asyncStorage.default.setItem('auth_token', userData.token);\n        await _asyncStorage.default.setItem('user_data', JSON.stringify({\n          id: userData.id,\n          anonymous_id: userData.anonymous_id,\n          display_name: userData.display_name\n        }));\n        setUser(userData);\n      } catch (error) {\n        console.error('Login error:', error);\n        _Alert.default.alert('Ошибка', 'Не удалось войти в приложение');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        await _asyncStorage.default.removeItem('auth_token');\n        await _asyncStorage.default.removeItem('user_data');\n        setUser(null);\n\n        // Immediately create new anonymous user\n        await login();\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _jsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        isAuthenticated\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 5\n    }, this);\n  }\n});","lineCount":103,"map":[[8,2,1,0],[8,6,1,0,"_react"],[8,12,1,0],[8,15,1,0,"_interopRequireWildcard"],[8,38,1,0],[8,39,1,0,"require"],[8,46,1,0],[8,47,1,0,"_dependencyMap"],[8,61,1,0],[9,2,2,0],[9,6,2,0,"_asyncStorage"],[9,19,2,0],[9,22,2,0,"_interopRequireDefault"],[9,44,2,0],[9,45,2,0,"require"],[9,52,2,0],[9,53,2,0,"_dependencyMap"],[9,67,2,0],[10,2,2,69],[10,6,2,69,"_Alert"],[10,12,2,69],[10,15,2,69,"_interopRequireDefault"],[10,37,2,69],[10,38,2,69,"require"],[10,45,2,69],[10,46,2,69,"_dependencyMap"],[10,60,2,69],[11,2,4,0],[11,6,4,0,"_api"],[11,10,4,0],[11,13,4,0,"require"],[11,20,4,0],[11,21,4,0,"_dependencyMap"],[11,35,4,0],[12,2,4,35],[12,6,4,35,"_jsxDevRuntime"],[12,20,4,35],[12,23,4,35,"require"],[12,30,4,35],[12,31,4,35,"_dependencyMap"],[12,45,4,35],[13,2,4,35],[13,6,4,35,"_jsxFileName"],[13,18,4,35],[14,2,4,35],[14,11,4,35,"_interopRequireWildcard"],[14,35,4,35,"e"],[14,36,4,35],[14,38,4,35,"t"],[14,39,4,35],[14,68,4,35,"WeakMap"],[14,75,4,35],[14,81,4,35,"r"],[14,82,4,35],[14,89,4,35,"WeakMap"],[14,96,4,35],[14,100,4,35,"n"],[14,101,4,35],[14,108,4,35,"WeakMap"],[14,115,4,35],[14,127,4,35,"_interopRequireWildcard"],[14,150,4,35],[14,162,4,35,"_interopRequireWildcard"],[14,163,4,35,"e"],[14,164,4,35],[14,166,4,35,"t"],[14,167,4,35],[14,176,4,35,"t"],[14,177,4,35],[14,181,4,35,"e"],[14,182,4,35],[14,186,4,35,"e"],[14,187,4,35],[14,188,4,35,"__esModule"],[14,198,4,35],[14,207,4,35,"e"],[14,208,4,35],[14,214,4,35,"o"],[14,215,4,35],[14,217,4,35,"i"],[14,218,4,35],[14,220,4,35,"f"],[14,221,4,35],[14,226,4,35,"__proto__"],[14,235,4,35],[14,243,4,35,"default"],[14,250,4,35],[14,252,4,35,"e"],[14,253,4,35],[14,270,4,35,"e"],[14,271,4,35],[14,294,4,35,"e"],[14,295,4,35],[14,320,4,35,"e"],[14,321,4,35],[14,330,4,35,"f"],[14,331,4,35],[14,337,4,35,"o"],[14,338,4,35],[14,341,4,35,"t"],[14,342,4,35],[14,345,4,35,"n"],[14,346,4,35],[14,349,4,35,"r"],[14,350,4,35],[14,358,4,35,"o"],[14,359,4,35],[14,360,4,35,"has"],[14,363,4,35],[14,364,4,35,"e"],[14,365,4,35],[14,375,4,35,"o"],[14,376,4,35],[14,377,4,35,"get"],[14,380,4,35],[14,381,4,35,"e"],[14,382,4,35],[14,385,4,35,"o"],[14,386,4,35],[14,387,4,35,"set"],[14,390,4,35],[14,391,4,35,"e"],[14,392,4,35],[14,394,4,35,"f"],[14,395,4,35],[14,411,4,35,"t"],[14,412,4,35],[14,416,4,35,"e"],[14,417,4,35],[14,433,4,35,"t"],[14,434,4,35],[14,441,4,35,"hasOwnProperty"],[14,455,4,35],[14,456,4,35,"call"],[14,460,4,35],[14,461,4,35,"e"],[14,462,4,35],[14,464,4,35,"t"],[14,465,4,35],[14,472,4,35,"i"],[14,473,4,35],[14,477,4,35,"o"],[14,478,4,35],[14,481,4,35,"Object"],[14,487,4,35],[14,488,4,35,"defineProperty"],[14,502,4,35],[14,507,4,35,"Object"],[14,513,4,35],[14,514,4,35,"getOwnPropertyDescriptor"],[14,538,4,35],[14,539,4,35,"e"],[14,540,4,35],[14,542,4,35,"t"],[14,543,4,35],[14,550,4,35,"i"],[14,551,4,35],[14,552,4,35,"get"],[14,555,4,35],[14,559,4,35,"i"],[14,560,4,35],[14,561,4,35,"set"],[14,564,4,35],[14,568,4,35,"o"],[14,569,4,35],[14,570,4,35,"f"],[14,571,4,35],[14,573,4,35,"t"],[14,574,4,35],[14,576,4,35,"i"],[14,577,4,35],[14,581,4,35,"f"],[14,582,4,35],[14,583,4,35,"t"],[14,584,4,35],[14,588,4,35,"e"],[14,589,4,35],[14,590,4,35,"t"],[14,591,4,35],[14,602,4,35,"f"],[14,603,4,35],[14,608,4,35,"e"],[14,609,4,35],[14,611,4,35,"t"],[14,612,4,35],[15,2,21,0],[15,8,21,6,"AuthContext"],[15,19,21,17],[15,35,21,20],[15,39,21,20,"createContext"],[15,59,21,33],[15,61,21,63,"undefined"],[15,70,21,72],[15,71,21,73],[16,2,23,7],[16,8,23,13,"useAuth"],[16,15,23,20],[16,18,23,23,"useAuth"],[16,19,23,23],[16,24,23,29],[17,4,24,2],[17,10,24,8,"context"],[17,17,24,15],[17,20,24,18],[17,24,24,18,"useContext"],[17,41,24,28],[17,43,24,29,"AuthContext"],[17,54,24,40],[17,55,24,41],[18,4,25,2],[18,8,25,6],[18,9,25,7,"context"],[18,16,25,14],[18,18,25,16],[19,6,26,4],[19,12,26,10],[19,16,26,14,"Error"],[19,21,26,19],[19,22,26,20],[19,67,26,65],[19,68,26,66],[20,4,27,2],[21,4,28,2],[21,11,28,9,"context"],[21,18,28,16],[22,2,29,0],[22,3,29,1],[23,2,29,2,"exports"],[23,9,29,2],[23,10,29,2,"useAuth"],[23,17,29,2],[23,20,29,2,"useAuth"],[23,27,29,2],[24,2,35,15],[24,11,35,24,"AuthProvider"],[24,23,35,36,"AuthProvider"],[24,24,35,37],[25,4,35,39,"children"],[26,2,35,67],[26,3,35,68],[26,5,35,70],[27,4,36,2],[27,10,36,8],[27,11,36,9,"user"],[27,15,36,13],[27,17,36,15,"setUser"],[27,24,36,22],[27,25,36,23],[27,28,36,26],[27,32,36,26,"useState"],[27,47,36,34],[27,49,36,48],[27,53,36,52],[27,54,36,53],[28,4,37,2],[28,10,37,8],[28,11,37,9,"isLoading"],[28,20,37,18],[28,22,37,20,"setIsLoading"],[28,34,37,32],[28,35,37,33],[28,38,37,36],[28,42,37,36,"useState"],[28,57,37,44],[28,59,37,45],[28,63,37,49],[28,64,37,50],[29,4,39,2],[29,10,39,8,"isAuthenticated"],[29,25,39,23],[29,28,39,26],[29,29,39,27],[29,30,39,28,"user"],[29,34,39,32],[30,4,41,2],[30,8,41,2,"useEffect"],[30,24,41,11],[30,26,41,12],[30,32,41,18],[31,6,42,4,"checkAuthStatus"],[31,21,42,19],[31,22,42,20],[31,23,42,21],[32,4,43,2],[32,5,43,3],[32,7,43,5],[32,9,43,7],[32,10,43,8],[33,4,45,2],[33,10,45,8,"checkAuthStatus"],[33,25,45,23],[33,28,45,26],[33,34,45,26,"checkAuthStatus"],[33,35,45,26],[33,40,45,38],[34,6,46,4],[34,10,46,8],[35,8,47,6],[35,14,47,12,"token"],[35,19,47,17],[35,22,47,20],[35,28,47,26,"AsyncStorage"],[35,49,47,38],[35,50,47,39,"getItem"],[35,57,47,46],[35,58,47,47],[35,70,47,59],[35,71,47,60],[36,8,48,6],[36,14,48,12,"userData"],[36,22,48,20],[36,25,48,23],[36,31,48,29,"AsyncStorage"],[36,52,48,41],[36,53,48,42,"getItem"],[36,60,48,49],[36,61,48,50],[36,72,48,61],[36,73,48,62],[37,8,50,6],[37,12,50,10,"token"],[37,17,50,15],[37,21,50,19,"userData"],[37,29,50,27],[37,31,50,29],[38,10,51,8],[38,16,51,14,"parsedUser"],[38,26,51,24],[38,29,51,27,"JSON"],[38,33,51,31],[38,34,51,32,"parse"],[38,39,51,37],[38,40,51,38,"userData"],[38,48,51,46],[38,49,51,47],[39,10,52,8,"setUser"],[39,17,52,15],[39,18,52,16],[40,12,52,18],[40,15,52,21,"parsedUser"],[40,25,52,31],[41,12,52,33,"token"],[42,10,52,39],[42,11,52,40],[42,12,52,41],[43,8,53,6],[43,9,53,7],[43,15,53,13],[44,10,54,8],[45,10,55,8],[45,16,55,14,"login"],[45,21,55,19],[45,22,55,20],[45,23,55,21],[46,8,56,6],[47,6,57,4],[47,7,57,5],[47,8,57,6],[47,15,57,13,"error"],[47,20,57,18],[47,22,57,20],[48,8,58,6,"console"],[48,15,58,13],[48,16,58,14,"log"],[48,19,58,17],[48,20,58,18],[48,39,58,37],[48,41,58,39,"error"],[48,46,58,44],[48,47,58,45],[49,8,59,6],[49,14,59,12,"login"],[49,19,59,17],[49,20,59,18],[49,21,59,19],[49,22,59,20],[49,23,59,21],[50,6,60,4],[50,7,60,5],[50,16,60,14],[51,8,61,6,"setIsLoading"],[51,20,61,18],[51,21,61,19],[51,26,61,24],[51,27,61,25],[52,6,62,4],[53,4,63,2],[53,5,63,3],[54,4,65,2],[54,10,65,8,"login"],[54,15,65,13],[54,18,65,16],[54,24,65,16,"login"],[54,25,65,16],[54,30,65,28],[55,6,66,4],[55,10,66,8],[56,8,67,6,"setIsLoading"],[56,20,67,18],[56,21,67,19],[56,25,67,23],[56,26,67,24],[57,8,69,6],[57,14,69,12,"response"],[57,22,69,20],[57,25,69,23],[57,31,69,29,"api"],[57,39,69,32],[57,40,69,33,"post"],[57,44,69,37],[57,45,69,38],[57,62,69,55],[57,64,69,57],[57,65,69,58],[57,66,69,59],[57,67,69,60],[58,8,71,6],[58,12,71,10],[58,13,71,11,"response"],[58,21,71,19],[58,22,71,20,"ok"],[58,24,71,22],[58,26,71,24],[59,10,72,8],[59,16,72,14],[59,20,72,18,"Error"],[59,25,72,23],[59,26,72,24],[59,59,72,57],[59,60,72,58],[60,8,73,6],[61,8,75,6],[61,14,75,12,"userData"],[61,22,75,20],[61,25,75,23],[61,31,75,29,"response"],[61,39,75,37],[61,40,75,38,"json"],[61,44,75,42],[61,45,75,43],[61,46,75,44],[62,8,77,6],[62,14,77,12,"AsyncStorage"],[62,35,77,24],[62,36,77,25,"setItem"],[62,43,77,32],[62,44,77,33],[62,56,77,45],[62,58,77,47,"userData"],[62,66,77,55],[62,67,77,56,"token"],[62,72,77,61],[62,73,77,62],[63,8,78,6],[63,14,78,12,"AsyncStorage"],[63,35,78,24],[63,36,78,25,"setItem"],[63,43,78,32],[63,44,78,33],[63,55,78,44],[63,57,78,46,"JSON"],[63,61,78,50],[63,62,78,51,"stringify"],[63,71,78,60],[63,72,78,61],[64,10,79,8,"id"],[64,12,79,10],[64,14,79,12,"userData"],[64,22,79,20],[64,23,79,21,"id"],[64,25,79,23],[65,10,80,8,"anonymous_id"],[65,22,80,20],[65,24,80,22,"userData"],[65,32,80,30],[65,33,80,31,"anonymous_id"],[65,45,80,43],[66,10,81,8,"display_name"],[66,22,81,20],[66,24,81,22,"userData"],[66,32,81,30],[66,33,81,31,"display_name"],[67,8,82,6],[67,9,82,7],[67,10,82,8],[67,11,82,9],[68,8,84,6,"setUser"],[68,15,84,13],[68,16,84,14,"userData"],[68,24,84,22],[68,25,84,23],[69,6,85,4],[69,7,85,5],[69,8,85,6],[69,15,85,13,"error"],[69,20,85,18],[69,22,85,20],[70,8,86,6,"console"],[70,15,86,13],[70,16,86,14,"error"],[70,21,86,19],[70,22,86,20],[70,36,86,34],[70,38,86,36,"error"],[70,43,86,41],[70,44,86,42],[71,8,87,6,"Alert"],[71,22,87,11],[71,23,87,12,"alert"],[71,28,87,17],[71,29,87,18],[71,37,87,26],[71,39,87,28],[71,70,87,59],[71,71,87,60],[72,6,88,4],[72,7,88,5],[72,16,88,14],[73,8,89,6,"setIsLoading"],[73,20,89,18],[73,21,89,19],[73,26,89,24],[73,27,89,25],[74,6,90,4],[75,4,91,2],[75,5,91,3],[76,4,93,2],[76,10,93,8,"logout"],[76,16,93,14],[76,19,93,17],[76,25,93,17,"logout"],[76,26,93,17],[76,31,93,29],[77,6,94,4],[77,10,94,8],[78,8,95,6],[78,14,95,12,"AsyncStorage"],[78,35,95,24],[78,36,95,25,"removeItem"],[78,46,95,35],[78,47,95,36],[78,59,95,48],[78,60,95,49],[79,8,96,6],[79,14,96,12,"AsyncStorage"],[79,35,96,24],[79,36,96,25,"removeItem"],[79,46,96,35],[79,47,96,36],[79,58,96,47],[79,59,96,48],[80,8,97,6,"setUser"],[80,15,97,13],[80,16,97,14],[80,20,97,18],[80,21,97,19],[82,8,99,6],[83,8,100,6],[83,14,100,12,"login"],[83,19,100,17],[83,20,100,18],[83,21,100,19],[84,6,101,4],[84,7,101,5],[84,8,101,6],[84,15,101,13,"error"],[84,20,101,18],[84,22,101,20],[85,8,102,6,"console"],[85,15,102,13],[85,16,102,14,"error"],[85,21,102,19],[85,22,102,20],[85,37,102,35],[85,39,102,37,"error"],[85,44,102,42],[85,45,102,43],[86,6,103,4],[87,4,104,2],[87,5,104,3],[88,4,106,2],[88,24,107,4],[88,28,107,4,"_jsxDevRuntime"],[88,42,107,4],[88,43,107,4,"jsxDEV"],[88,49,107,4],[88,51,107,5,"AuthContext"],[88,62,107,16],[88,63,107,17,"Provider"],[88,71,107,25],[89,6,107,26,"value"],[89,11,107,31],[89,13,107,33],[90,8,107,35,"user"],[90,12,107,39],[91,8,107,41,"isLoading"],[91,17,107,50],[92,8,107,52,"login"],[92,13,107,57],[93,8,107,59,"logout"],[93,14,107,65],[94,8,107,67,"isAuthenticated"],[95,6,107,83],[95,7,107,85],[96,6,107,85,"children"],[96,14,107,85],[96,16,108,7,"children"],[97,4,108,15],[98,6,108,15,"fileName"],[98,14,108,15],[98,16,108,15,"_jsxFileName"],[98,28,108,15],[99,6,108,15,"lineNumber"],[99,16,108,15],[100,6,108,15,"columnNumber"],[100,18,108,15],[101,4,108,15],[101,11,109,26],[101,12,109,27],[102,2,111,0],[103,0,111,1],[103,3]],"functionMap":{"names":["<global>","useAuth","AuthProvider","useEffect$argument_0","checkAuthStatus","login","logout"],"mappings":"AAA;uBCsB;CDM;eEM;YCM;GDE;0BEE;GFkB;gBGE;GH0B;iBIE;GJW"}},"type":"js/module"}]}