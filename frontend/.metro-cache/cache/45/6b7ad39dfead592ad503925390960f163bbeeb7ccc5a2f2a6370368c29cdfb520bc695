{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"]}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/Alert","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"PEUC6jrQVoAGZ2qYkvimljMOyJI=","exportNames":["*"]}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = AuthProvider;\n  exports.useAuth = void 0;\n  var _react = _interopRequireWildcard(require(_dependencyMap[1], \"react\"));\n  var _asyncStorage = _interopRequireDefault(require(_dependencyMap[2], \"@react-native-async-storage/async-storage\"));\n  var _Alert = _interopRequireDefault(require(_dependencyMap[3], \"react-native-web/dist/exports/Alert\"));\n  var _jsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\";\n  function _interopRequireWildcard(e, t) { if (\"function\" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) \"default\" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const useAuth = () => {\n    const context = (0, _react.useContext)(AuthContext);\n    if (!context) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n  exports.useAuth = useAuth;\n  const API_BASE_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const isAuthenticated = !!user;\n    (0, _react.useEffect)(() => {\n      checkAuthStatus();\n    }, []);\n    const checkAuthStatus = async () => {\n      try {\n        const token = await _asyncStorage.default.getItem('auth_token');\n        const userData = await _asyncStorage.default.getItem('user_data');\n        if (token && userData) {\n          const parsedUser = JSON.parse(userData);\n          setUser({\n            ...parsedUser,\n            token\n          });\n        } else {\n          // Auto-login for anonymous users\n          await login();\n        }\n      } catch (error) {\n        console.log('Auth check error:', error);\n        await login(); // Fallback to anonymous login\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async () => {\n      try {\n        setIsLoading(true);\n        const response = await fetch(`${API_BASE_URL}/api/auth/anonymous`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        if (!response.ok) {\n          throw new Error('Failed to create anonymous user');\n        }\n        const userData = await response.json();\n        await _asyncStorage.default.setItem('auth_token', userData.token);\n        await _asyncStorage.default.setItem('user_data', JSON.stringify({\n          id: userData.id,\n          anonymous_id: userData.anonymous_id,\n          display_name: userData.display_name\n        }));\n        setUser(userData);\n      } catch (error) {\n        console.error('Login error:', error);\n        _Alert.default.alert('Ошибка', 'Не удалось войти в приложение');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        await _asyncStorage.default.removeItem('auth_token');\n        await _asyncStorage.default.removeItem('user_data');\n        setUser(null);\n\n        // Immediately create new anonymous user\n        await login();\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _jsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        isAuthenticated\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }, this);\n  }\n});","lineCount":108,"map":[[8,2,1,0],[8,6,1,0,"_react"],[8,12,1,0],[8,15,1,0,"_interopRequireWildcard"],[8,38,1,0],[8,39,1,0,"require"],[8,46,1,0],[8,47,1,0,"_dependencyMap"],[8,61,1,0],[9,2,2,0],[9,6,2,0,"_asyncStorage"],[9,19,2,0],[9,22,2,0,"_interopRequireDefault"],[9,44,2,0],[9,45,2,0,"require"],[9,52,2,0],[9,53,2,0,"_dependencyMap"],[9,67,2,0],[10,2,2,69],[10,6,2,69,"_Alert"],[10,12,2,69],[10,15,2,69,"_interopRequireDefault"],[10,37,2,69],[10,38,2,69,"require"],[10,45,2,69],[10,46,2,69,"_dependencyMap"],[10,60,2,69],[11,2,2,69],[11,6,2,69,"_jsxDevRuntime"],[11,20,2,69],[11,23,2,69,"require"],[11,30,2,69],[11,31,2,69,"_dependencyMap"],[11,45,2,69],[12,2,2,69],[12,6,2,69,"_jsxFileName"],[12,18,2,69],[13,2,2,69],[13,11,2,69,"_interopRequireWildcard"],[13,35,2,69,"e"],[13,36,2,69],[13,38,2,69,"t"],[13,39,2,69],[13,68,2,69,"WeakMap"],[13,75,2,69],[13,81,2,69,"r"],[13,82,2,69],[13,89,2,69,"WeakMap"],[13,96,2,69],[13,100,2,69,"n"],[13,101,2,69],[13,108,2,69,"WeakMap"],[13,115,2,69],[13,127,2,69,"_interopRequireWildcard"],[13,150,2,69],[13,162,2,69,"_interopRequireWildcard"],[13,163,2,69,"e"],[13,164,2,69],[13,166,2,69,"t"],[13,167,2,69],[13,176,2,69,"t"],[13,177,2,69],[13,181,2,69,"e"],[13,182,2,69],[13,186,2,69,"e"],[13,187,2,69],[13,188,2,69,"__esModule"],[13,198,2,69],[13,207,2,69,"e"],[13,208,2,69],[13,214,2,69,"o"],[13,215,2,69],[13,217,2,69,"i"],[13,218,2,69],[13,220,2,69,"f"],[13,221,2,69],[13,226,2,69,"__proto__"],[13,235,2,69],[13,243,2,69,"default"],[13,250,2,69],[13,252,2,69,"e"],[13,253,2,69],[13,270,2,69,"e"],[13,271,2,69],[13,294,2,69,"e"],[13,295,2,69],[13,320,2,69,"e"],[13,321,2,69],[13,330,2,69,"f"],[13,331,2,69],[13,337,2,69,"o"],[13,338,2,69],[13,341,2,69,"t"],[13,342,2,69],[13,345,2,69,"n"],[13,346,2,69],[13,349,2,69,"r"],[13,350,2,69],[13,358,2,69,"o"],[13,359,2,69],[13,360,2,69,"has"],[13,363,2,69],[13,364,2,69,"e"],[13,365,2,69],[13,375,2,69,"o"],[13,376,2,69],[13,377,2,69,"get"],[13,380,2,69],[13,381,2,69,"e"],[13,382,2,69],[13,385,2,69,"o"],[13,386,2,69],[13,387,2,69,"set"],[13,390,2,69],[13,391,2,69,"e"],[13,392,2,69],[13,394,2,69,"f"],[13,395,2,69],[13,411,2,69,"t"],[13,412,2,69],[13,416,2,69,"e"],[13,417,2,69],[13,433,2,69,"t"],[13,434,2,69],[13,441,2,69,"hasOwnProperty"],[13,455,2,69],[13,456,2,69,"call"],[13,460,2,69],[13,461,2,69,"e"],[13,462,2,69],[13,464,2,69,"t"],[13,465,2,69],[13,472,2,69,"i"],[13,473,2,69],[13,477,2,69,"o"],[13,478,2,69],[13,481,2,69,"Object"],[13,487,2,69],[13,488,2,69,"defineProperty"],[13,502,2,69],[13,507,2,69,"Object"],[13,513,2,69],[13,514,2,69,"getOwnPropertyDescriptor"],[13,538,2,69],[13,539,2,69,"e"],[13,540,2,69],[13,542,2,69,"t"],[13,543,2,69],[13,550,2,69,"i"],[13,551,2,69],[13,552,2,69,"get"],[13,555,2,69],[13,559,2,69,"i"],[13,560,2,69],[13,561,2,69,"set"],[13,564,2,69],[13,568,2,69,"o"],[13,569,2,69],[13,570,2,69,"f"],[13,571,2,69],[13,573,2,69,"t"],[13,574,2,69],[13,576,2,69,"i"],[13,577,2,69],[13,581,2,69,"f"],[13,582,2,69],[13,583,2,69,"t"],[13,584,2,69],[13,588,2,69,"e"],[13,589,2,69],[13,590,2,69,"t"],[13,591,2,69],[13,602,2,69,"f"],[13,603,2,69],[13,608,2,69,"e"],[13,609,2,69],[13,611,2,69,"t"],[13,612,2,69],[14,2,20,0],[14,8,20,6,"AuthContext"],[14,19,20,17],[14,35,20,20],[14,39,20,20,"createContext"],[14,59,20,33],[14,61,20,63,"undefined"],[14,70,20,72],[14,71,20,73],[15,2,22,7],[15,8,22,13,"useAuth"],[15,15,22,20],[15,18,22,23,"useAuth"],[15,19,22,23],[15,24,22,29],[16,4,23,2],[16,10,23,8,"context"],[16,17,23,15],[16,20,23,18],[16,24,23,18,"useContext"],[16,41,23,28],[16,43,23,29,"AuthContext"],[16,54,23,40],[16,55,23,41],[17,4,24,2],[17,8,24,6],[17,9,24,7,"context"],[17,16,24,14],[17,18,24,16],[18,6,25,4],[18,12,25,10],[18,16,25,14,"Error"],[18,21,25,19],[18,22,25,20],[18,67,25,65],[18,68,25,66],[19,4,26,2],[20,4,27,2],[20,11,27,9,"context"],[20,18,27,16],[21,2,28,0],[21,3,28,1],[22,2,28,2,"exports"],[22,9,28,2],[22,10,28,2,"useAuth"],[22,17,28,2],[22,20,28,2,"useAuth"],[22,27,28,2],[23,2,34,0],[23,8,34,6,"API_BASE_URL"],[23,20,34,18],[23,23,34,21,"process"],[23,30,34,28],[23,31,34,29,"env"],[23,34,34,32],[23,35,34,33,"EXPO_PUBLIC_BACKEND_URL"],[23,58,34,56],[24,2,36,15],[24,11,36,24,"AuthProvider"],[24,23,36,36,"AuthProvider"],[24,24,36,37],[25,4,36,39,"children"],[26,2,36,67],[26,3,36,68],[26,5,36,70],[27,4,37,2],[27,10,37,8],[27,11,37,9,"user"],[27,15,37,13],[27,17,37,15,"setUser"],[27,24,37,22],[27,25,37,23],[27,28,37,26],[27,32,37,26,"useState"],[27,47,37,34],[27,49,37,48],[27,53,37,52],[27,54,37,53],[28,4,38,2],[28,10,38,8],[28,11,38,9,"isLoading"],[28,20,38,18],[28,22,38,20,"setIsLoading"],[28,34,38,32],[28,35,38,33],[28,38,38,36],[28,42,38,36,"useState"],[28,57,38,44],[28,59,38,45],[28,63,38,49],[28,64,38,50],[29,4,40,2],[29,10,40,8,"isAuthenticated"],[29,25,40,23],[29,28,40,26],[29,29,40,27],[29,30,40,28,"user"],[29,34,40,32],[30,4,42,2],[30,8,42,2,"useEffect"],[30,24,42,11],[30,26,42,12],[30,32,42,18],[31,6,43,4,"checkAuthStatus"],[31,21,43,19],[31,22,43,20],[31,23,43,21],[32,4,44,2],[32,5,44,3],[32,7,44,5],[32,9,44,7],[32,10,44,8],[33,4,46,2],[33,10,46,8,"checkAuthStatus"],[33,25,46,23],[33,28,46,26],[33,34,46,26,"checkAuthStatus"],[33,35,46,26],[33,40,46,38],[34,6,47,4],[34,10,47,8],[35,8,48,6],[35,14,48,12,"token"],[35,19,48,17],[35,22,48,20],[35,28,48,26,"AsyncStorage"],[35,49,48,38],[35,50,48,39,"getItem"],[35,57,48,46],[35,58,48,47],[35,70,48,59],[35,71,48,60],[36,8,49,6],[36,14,49,12,"userData"],[36,22,49,20],[36,25,49,23],[36,31,49,29,"AsyncStorage"],[36,52,49,41],[36,53,49,42,"getItem"],[36,60,49,49],[36,61,49,50],[36,72,49,61],[36,73,49,62],[37,8,51,6],[37,12,51,10,"token"],[37,17,51,15],[37,21,51,19,"userData"],[37,29,51,27],[37,31,51,29],[38,10,52,8],[38,16,52,14,"parsedUser"],[38,26,52,24],[38,29,52,27,"JSON"],[38,33,52,31],[38,34,52,32,"parse"],[38,39,52,37],[38,40,52,38,"userData"],[38,48,52,46],[38,49,52,47],[39,10,53,8,"setUser"],[39,17,53,15],[39,18,53,16],[40,12,53,18],[40,15,53,21,"parsedUser"],[40,25,53,31],[41,12,53,33,"token"],[42,10,53,39],[42,11,53,40],[42,12,53,41],[43,8,54,6],[43,9,54,7],[43,15,54,13],[44,10,55,8],[45,10,56,8],[45,16,56,14,"login"],[45,21,56,19],[45,22,56,20],[45,23,56,21],[46,8,57,6],[47,6,58,4],[47,7,58,5],[47,8,58,6],[47,15,58,13,"error"],[47,20,58,18],[47,22,58,20],[48,8,59,6,"console"],[48,15,59,13],[48,16,59,14,"log"],[48,19,59,17],[48,20,59,18],[48,39,59,37],[48,41,59,39,"error"],[48,46,59,44],[48,47,59,45],[49,8,60,6],[49,14,60,12,"login"],[49,19,60,17],[49,20,60,18],[49,21,60,19],[49,22,60,20],[49,23,60,21],[50,6,61,4],[50,7,61,5],[50,16,61,14],[51,8,62,6,"setIsLoading"],[51,20,62,18],[51,21,62,19],[51,26,62,24],[51,27,62,25],[52,6,63,4],[53,4,64,2],[53,5,64,3],[54,4,66,2],[54,10,66,8,"login"],[54,15,66,13],[54,18,66,16],[54,24,66,16,"login"],[54,25,66,16],[54,30,66,28],[55,6,67,4],[55,10,67,8],[56,8,68,6,"setIsLoading"],[56,20,68,18],[56,21,68,19],[56,25,68,23],[56,26,68,24],[57,8,70,6],[57,14,70,12,"response"],[57,22,70,20],[57,25,70,23],[57,31,70,29,"fetch"],[57,36,70,34],[57,37,70,35],[57,40,70,38,"API_BASE_URL"],[57,52,70,50],[57,73,70,71],[57,75,70,73],[58,10,71,8,"method"],[58,16,71,14],[58,18,71,16],[58,24,71,22],[59,10,72,8,"headers"],[59,17,72,15],[59,19,72,17],[60,12,73,10],[60,26,73,24],[60,28,73,26],[61,10,74,8],[62,8,75,6],[62,9,75,7],[62,10,75,8],[63,8,77,6],[63,12,77,10],[63,13,77,11,"response"],[63,21,77,19],[63,22,77,20,"ok"],[63,24,77,22],[63,26,77,24],[64,10,78,8],[64,16,78,14],[64,20,78,18,"Error"],[64,25,78,23],[64,26,78,24],[64,59,78,57],[64,60,78,58],[65,8,79,6],[66,8,81,6],[66,14,81,12,"userData"],[66,22,81,20],[66,25,81,23],[66,31,81,29,"response"],[66,39,81,37],[66,40,81,38,"json"],[66,44,81,42],[66,45,81,43],[66,46,81,44],[67,8,83,6],[67,14,83,12,"AsyncStorage"],[67,35,83,24],[67,36,83,25,"setItem"],[67,43,83,32],[67,44,83,33],[67,56,83,45],[67,58,83,47,"userData"],[67,66,83,55],[67,67,83,56,"token"],[67,72,83,61],[67,73,83,62],[68,8,84,6],[68,14,84,12,"AsyncStorage"],[68,35,84,24],[68,36,84,25,"setItem"],[68,43,84,32],[68,44,84,33],[68,55,84,44],[68,57,84,46,"JSON"],[68,61,84,50],[68,62,84,51,"stringify"],[68,71,84,60],[68,72,84,61],[69,10,85,8,"id"],[69,12,85,10],[69,14,85,12,"userData"],[69,22,85,20],[69,23,85,21,"id"],[69,25,85,23],[70,10,86,8,"anonymous_id"],[70,22,86,20],[70,24,86,22,"userData"],[70,32,86,30],[70,33,86,31,"anonymous_id"],[70,45,86,43],[71,10,87,8,"display_name"],[71,22,87,20],[71,24,87,22,"userData"],[71,32,87,30],[71,33,87,31,"display_name"],[72,8,88,6],[72,9,88,7],[72,10,88,8],[72,11,88,9],[73,8,90,6,"setUser"],[73,15,90,13],[73,16,90,14,"userData"],[73,24,90,22],[73,25,90,23],[74,6,91,4],[74,7,91,5],[74,8,91,6],[74,15,91,13,"error"],[74,20,91,18],[74,22,91,20],[75,8,92,6,"console"],[75,15,92,13],[75,16,92,14,"error"],[75,21,92,19],[75,22,92,20],[75,36,92,34],[75,38,92,36,"error"],[75,43,92,41],[75,44,92,42],[76,8,93,6,"Alert"],[76,22,93,11],[76,23,93,12,"alert"],[76,28,93,17],[76,29,93,18],[76,37,93,26],[76,39,93,28],[76,70,93,59],[76,71,93,60],[77,6,94,4],[77,7,94,5],[77,16,94,14],[78,8,95,6,"setIsLoading"],[78,20,95,18],[78,21,95,19],[78,26,95,24],[78,27,95,25],[79,6,96,4],[80,4,97,2],[80,5,97,3],[81,4,99,2],[81,10,99,8,"logout"],[81,16,99,14],[81,19,99,17],[81,25,99,17,"logout"],[81,26,99,17],[81,31,99,29],[82,6,100,4],[82,10,100,8],[83,8,101,6],[83,14,101,12,"AsyncStorage"],[83,35,101,24],[83,36,101,25,"removeItem"],[83,46,101,35],[83,47,101,36],[83,59,101,48],[83,60,101,49],[84,8,102,6],[84,14,102,12,"AsyncStorage"],[84,35,102,24],[84,36,102,25,"removeItem"],[84,46,102,35],[84,47,102,36],[84,58,102,47],[84,59,102,48],[85,8,103,6,"setUser"],[85,15,103,13],[85,16,103,14],[85,20,103,18],[85,21,103,19],[87,8,105,6],[88,8,106,6],[88,14,106,12,"login"],[88,19,106,17],[88,20,106,18],[88,21,106,19],[89,6,107,4],[89,7,107,5],[89,8,107,6],[89,15,107,13,"error"],[89,20,107,18],[89,22,107,20],[90,8,108,6,"console"],[90,15,108,13],[90,16,108,14,"error"],[90,21,108,19],[90,22,108,20],[90,37,108,35],[90,39,108,37,"error"],[90,44,108,42],[90,45,108,43],[91,6,109,4],[92,4,110,2],[92,5,110,3],[93,4,112,2],[93,24,113,4],[93,28,113,4,"_jsxDevRuntime"],[93,42,113,4],[93,43,113,4,"jsxDEV"],[93,49,113,4],[93,51,113,5,"AuthContext"],[93,62,113,16],[93,63,113,17,"Provider"],[93,71,113,25],[94,6,113,26,"value"],[94,11,113,31],[94,13,113,33],[95,8,113,35,"user"],[95,12,113,39],[96,8,113,41,"isLoading"],[96,17,113,50],[97,8,113,52,"login"],[97,13,113,57],[98,8,113,59,"logout"],[98,14,113,65],[99,8,113,67,"isAuthenticated"],[100,6,113,83],[100,7,113,85],[101,6,113,85,"children"],[101,14,113,85],[101,16,114,7,"children"],[102,4,114,15],[103,6,114,15,"fileName"],[103,14,114,15],[103,16,114,15,"_jsxFileName"],[103,28,114,15],[104,6,114,15,"lineNumber"],[104,16,114,15],[105,6,114,15,"columnNumber"],[105,18,114,15],[106,4,114,15],[106,11,115,26],[106,12,115,27],[107,2,117,0],[108,0,117,1],[108,3]],"functionMap":{"names":["<global>","useAuth","AuthProvider","useEffect$argument_0","checkAuthStatus","login","logout"],"mappings":"AAA;uBCqB;CDM;eEQ;YCM;GDE;0BEE;GFkB;gBGE;GH+B;iBIE;GJW"}},"type":"js/module"}]}